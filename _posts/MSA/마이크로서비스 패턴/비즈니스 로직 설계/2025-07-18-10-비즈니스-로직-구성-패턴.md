---
layout: single
title: "1. 비즈니스 로직 구성 패턴"
categories:
  - MSA
  - 마이크로서비스 패턴
  - 비즈니스 로직 설계
tags:
  - MSA
  - 비즈니스로직
  - 트랜잭션스크립트
  - 도메인모델
toc: true
toc_sticky: true
---

# 0. 주문 서비스 아키텍처 구조

## 1. 육각형 아키텍처

- 주문 서비스는 중심에 비즈니스 로직이 있고, 인바운드/아웃바운드 어댑터가 주변을 감싼 육각형 아키텍처 구조
    
    ![20241128_140932.png](/assets/images/MSA/마이크로서비스 패턴/비즈니스 로직 설계/10-비즈니스-로직-구성-패턴/20241128_140932.png)
    

## 2. 인바운드 어댑터

- 클라이언트 요청을 받아 비즈니스 로직을 호출
    
    
    
    - **REST API 어댑터**: 비즈니스 로직을 호출하는 REST API가 구현됨
    - **`OrderCommandHandlers`**: 메시지 채널에서 들어온 커맨드 메시지를 받아, 비즈니스 로직 호출
    
    

## 3. 아웃바운드 어댑터

- 비즈니스 로직의 호출을 받아 다른 서비스 및 애플리케이션 실행
    
    
    
    - **DB 어댑터**: 비즈니스 로직이 DB 접근을 위해 호출
    - **도메인 이벤트 발행 어댑터**: 이벤트를 메시지 브로커에 발행
    
    

# 1. 트랜잭션 스크립트 패턴

- 비즈니스 로직을 요청 타입별로 하나씩 매핑된 절차적 트랜잭션 스크립트 뭉치로 구성
- 동작이 구현된 클래스, 상태를 보관하는 클래스로 구성됨
    
    ![20241128_140952.png](/assets/images/MSA/마이크로서비스 패턴/비즈니스 로직 설계/10-비즈니스-로직-구성-패턴/20241128_140952.png)
    



- **장점**: 클래스를 어떻게 구성할지 고민하지 않고 단순하게 코딩이 가능
- **단점**: 복잡한 비즈니스 로직에는 맞지 않음


# 2. 도메인 모델 패턴

## 1. 도메인 모델이란?

- 비즈니스 로직을 상태와 동작을 가진 클래스로 구성된 객체 모델로 구성
- 도메인 모델 패턴을 적용하면, 서비스 메서드가 단순해짐
    - 서비스 메서드는 비즈니스 로직 수행을 도메인 객체에 위임하기 때문
    - DB에서 도메인 객체를 로드하고, 객체의 메서드를 호출

![20241128_141020.png](/assets/images/MSA/마이크로서비스 패턴/비즈니스 로직 설계/10-비즈니스-로직-구성-패턴/20241128_141020.png)

## 2. 장점



- **설계 이해/관리에 쉬움**: 도메인 객체를 이용해 실세계에 더 가깝게 설계할 수 있음
    - 소수의 책임만 맡은 아담한 여러 클래스로 구성되기 때문

- **테스트하기 쉬움**: 각 클래스의 독립적인 테스트가 가능
- **확장하기 쉬움**: 잘 알려진 설계 패턴을 적용할 수 있어, 확장에 용이


## 3. 단점



- MSA 환경에 적용할 때, 해결해야 하는 문제가 많음


# 3. 도메인 주도 설계 개요

## 1. DDD란?

- 복잡한 비즈니스 로직 개발을 위해 OOD를 개선한 접근 방식
- 각 서비스는 자체 도메인 모델을 가지며, 애플리케이션 전체 도메인 모델의 문제점 방지가 가능

## 2. 도메인 모델 구성 요소



- **엔티티**: 영속성을 가진 객체
- **밸류 객체**: 여러 값을  모아 놓은 객체
- **팩토리**: 일반 생성자로 구현하기 복잡한 객체 생성 로직이 구현된 객체 또는 메서드
- **리포지터리**: 엔티티를 저장하는 DB 접근 로직을 캡슐화한 객체
- **서비스**: 엔티티, 밸류 객체에 속하지 않은 비즈니스 로직 구현 객체