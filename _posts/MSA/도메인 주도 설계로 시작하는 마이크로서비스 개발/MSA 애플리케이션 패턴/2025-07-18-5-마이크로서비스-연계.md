---
layout: single
title: "5. 마이크로서비스 연계"
categories:
  - MSA
  - 도메인 주도 설계로 시작하는 마이크로서비스 개발
  - MSA 애플리케이션 패턴
tags:
  - MSA
  - 서비스연계
  - API조합
  - 의존성
toc: true
toc_sticky: true
---

# 1. 문제: 서비스 연계

- 각 서비스가 각기 다른 기능을 구현할 때, 여러 서비스를 연계해 서비스로 제공해야 할 수도

# 2. 해결책?: API 조합

- 여러 마이크로서비스를 조합하는 상위 마이크로서비스를 만들어 조합된 기능을 제공
    
    ![2.45.png](/assets/images/MSA/도메인 주도 설계로 시작하는 마이크로서비스 개발/MSA 애플리케이션 패턴/05-마이크로서비스-연계/2.45.png)
    

# 3. API 조합의 한계: 의존성

- 상위 서비스가 하위 서비스에 의존하게 됨
    - 하위 서비스 중 하나라도 API를 변경하면, 상위 서비스는 그에 따라 변경되어야
    - 하위 서비스의 실패가 상위 서비스에 영향을 끼침

# 4. 해결책: CQRS

- 조회용 서비스를 생성해, 각 서비스가 정보 변경 시점에 발행하는 이벤트를 구독
    
    ![2.46.png](/assets/images/MSA/도메인 주도 설계로 시작하는 마이크로서비스 개발/MSA 애플리케이션 패턴/05-마이크로서비스-연계/2.46.png)
    
    - 조회용 서비스는 이벤트 구독을 통해 데이터의 일관성을 맞춤
    - 특정 원천 서비스에 장애가 발생해도, 조회용 서비스는 영향을 받지 않음

- 조회용 서비스를 생성하고, 비동기 이벤트로 일관성을 맞춰, 서비스간 의존성을 줄임